<!DOCTYPE html>
<html>
<head>
    <title>[Post Title] - DaikonScramble Devlog</title>
    <link rel="stylesheet" href="./css/devlog.css">
    <link rel="alternate" type="application/rss+xml" title="DaikonScramble Devlog RSS" href="/feed.xml">
    <link rel="alternate" type="application/rss+xml" title="DaikonScramble Devlog" href="/feed.xml">

</head>

<body class="crt">

<div class="container">

    <!-- === TOP BAR === -->
    <div class="bar">
        <span>DaikonScramble Devlog</span>
    </div>
    <div class="bunny-button"><img src="./assets/bunny-button.png" alt="Bunny Icon"></div>

    <!-- === MAIN GRID === -->
    <div class="main">
        <div class="navigation">
            <div class="title">Navigation</div>
            <div class="button"><a href="./index.html">Home</a></div>
            <div class="button"><a href="./devlog.html">Devlog</a></div>
            <div class="button" style="border-bottom:1px solid var(--border-color);"><a href="./assets.html">Assets</a></div>
        </div>

        <!-- === POST HISTORY AREA === -->
            <div class="box">

            <div class="box-content">
                <div class="pearl-left"><img src="./assets/pearl.png" alt=""></div>

                <div class="devlog-links">
                    <p><a href="#" data-log="./logs/devlog-0-1.html">Devlog 0.1 — Emotional Burrows & Research Rabbit Holes</a></p>
                    <!-- more links later -->
                </div>

                <div class="pearl-right"><img src="./assets/pearl.png" alt=""></div>
            </div>

            </div>



        <!-- === CONTENT AREA === -->
        <div class="content">

            

        </div>
    </div>

    <!-- === FOOTER === -->
    <div class="footer">
        DaikonSoft © 2025
    </div>

</div>
<script>
// === INITIALIZATION ===
function init() {
    setupCRTButton();
    setupDevlogLinks();
    restoreInitialDevlog();
}


// === CRT TOGGLE ===
function setupCRTButton() {
    const btn = document.querySelector('.bunny-button');
    if (!btn) return;

    // Remove old listeners if they exist to prevent duplicates
    btn.replaceWith(btn.cloneNode(true));
    const freshBtn = document.querySelector('.bunny-button');

    freshBtn.addEventListener('click', () => {
        document.body.classList.toggle('fx');
    });
}


// === DEVLOG LINK HANDLERS ===
function setupDevlogLinks() {
    document.querySelectorAll('.devlog-links a[data-log]').forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const logFile = link.getAttribute('data-log')
                .replace("./logs/", "")
                .replace(".html", "");
            loadDevlog(logFile);
        });
    });
}


// === LOAD DEVLOG ===
async function loadDevlog(logName) {
    const url = `./logs/${logName}.html`;

    try {
        const response = await fetch(url);
        const text = await response.text();

        const parser = new DOMParser();
        const doc = parser.parseFromString(text, "text/html");

        const newContent = doc.querySelector('.content');
        const container = document.querySelector('.content');

        container.innerHTML = newContent.innerHTML;

        document.title = doc.title || "DaikonScramble Devlog";

        history.pushState({ log: logName }, "", `?log=${logName}`);
    } catch (err) {
        console.error("Failed to load devlog:", err);
    }
}


// === HANDLE BACK/FORWARD NAVIGATION ===
window.onpopstate = (event) => {
    if (event.state && event.state.log) {
        loadDevlog(event.state.log);
    }
};


// === AUTOLOAD FIRST POST ===
function restoreInitialDevlog() {
    const params = new URLSearchParams(window.location.search);
    const initialLog = params.get("log");

    if (initialLog) {
        loadDevlog(initialLog);
        return;
    }

    // If no log parameter, load the first item
    const firstPost = document.querySelector('.devlog-links a[data-log]');
    if (firstPost) {
        const logFile = firstPost.getAttribute('data-log')
            .replace("./logs/", "")
            .replace(".html", "");
        loadDevlog(logFile);
    }
}


// === RUN INIT  ===
window.addEventListener("pageshow", init);

</script>

</body>
</html>
